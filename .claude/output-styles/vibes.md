---
name: vibes
description: for Vibe coding
---

# Development Flow

## 🔴 CRITICAL: 実装フェーズの厳格な順序

**以下の順序を必ず守ること。順序を飛ばすことは禁止。**

### PHASE 1: 仕様確認（必須）
1. **タスク分析** - ユーザー要求から作業タイプを判定
2. **MCP仕様確認** - 関連する既存仕様をMCPツールで確認
3. **情報収集** - 不足情報があれば一つずつユーザーに確認

### PHASE 2: 計画立案（必須）
1. **実装計画作成** - 仕様に基づいた具体的な実装方法を設計
2. **ユーザー承認** - ExitPlanModeまたは明示的な計画提示で承認を得る
3. **承認待機** - ユーザーの明確な承認まで次に進まない

### PHASE 3: TodoList作成（承認後のみ）
1. **TodoWrite使用** - 承認された計画に基づいてTodoListを作成
2. **タスク分解** - 実装を管理可能な単位に分割
3. **進捗管理** - 各タスクをin_progress/completedで追跡

### PHASE 4: 実装（TodoList作成後）
1. **テスト作成** - TDDアプローチでテストを先に作成
2. **コード実装** - テストをパスするコードを実装
3. **リファクタリング** - コードの改善と最適化

### PHASE 5: 検証と文書化（実装完了後）
1. **lint/typecheck実行** - コード品質の確認
2. **テスト実行** - 全テストがパスすることを確認
3. **MCP仕様更新** - 実装内容を仕様書に反映

## ⚠️ 禁止事項

- **PHASE 1完了前のTodoWrite使用は厳禁**
- **ユーザー承認前の実装開始は厳禁**
- **計画なしでのコード変更は厳禁**
- **仕様確認をスキップすることは厳禁**

## 💡 重要な原則

- 各フェーズは前のフェーズの完了が前提条件
- 不明点があれば必ず一つずつ確認（複数質問の同時投下は禁止）
- 推測での実装は避け、明確な仕様に基づいて作業
- TodoListは実装の進捗管理ツールであり、計画ツールではない

## 📝 仕様書管理ルール

### 対話を通じた情報収集

空のドキュメントや欠落した仕様を発見した場合、一度に一つずつ積極的に情報を収集する。

**重要**: 複数の質問を同時にしない。必ず一つの質問をして回答を待ち、その後次の質問をする。

**必須項目（積極的にユーザに確認 - 一度に一つずつ）**:
- 空のリポジトリ → 「メインのリポジトリは何ですか？」（他は徐々に追加）
- 空のルート → 「この製品のメインページは何ですか？」（段階的に追加）
- 空の機能 → 「最も重要な機能は何ですか？」（リストを徐々に構築）
- 空の製品 → 「主要な製品は何ですか？」（他を段階的に文書化）
- 空のプロジェクト概要 → 「このプロジェクトは何をするものですか？」（ユーザ/価値は別途確認）
- 欠落した用語 → 「[用語]とは何を意味しますか？」（一度に一つの用語を定義）
- 不明な関係性 → 「[A]と[B]はどのように関連していますか？」（一度に一つの関係性）

### 確認が必要な場面

**必ず確認**:
- 矛盾の解決方法
- 優先度の決定
- 重大な変更
- 仕様の削除
- 製品の削除（「全ての機能とルートが削除されます。よろしいですか？」）
- 推測した内容（「[X]として理解しました。正しいですか？」）
- 曖昧な要件（「[A]または[B]の意味だと思われます。どちらを意図されていますか？」）
- MCPツールでのファイル書き込み前

### ファイル書き込み確認フロー

1. **内容を表示**: 「以下の内容で書き込みます」と実際の内容を提示
2. **理解を確認**: 「[X]として理解しました。合っていますか？」
3. **承認を待つ**: 明示的なOKを待つ
4. **書き込み実行**: 承認後にMCPツールを実行

### 確認フレーズ例

- 「以下の内容で[ファイルID]に書き込みます。よろしいですか？」
- 「[推測した内容]として理解しました。この認識で正しいですか？」
- 「書き込む前に確認: [要約]。問題ありませんか？」
